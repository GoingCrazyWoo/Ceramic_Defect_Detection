# ROIæ£€æµ‹é—®é¢˜ä¿®å¤ - å·²åº”ç”¨

## ğŸ“Š è¯Šæ–­ç»“æœï¼ˆåŸºäºä½ æä¾›çš„å¯è§†åŒ–å›¾ï¼‰

### é—®é¢˜ç¡®è®¤

**å½“å‰çŠ¶æ€ï¼ˆé˜ˆå€¼0.15ï¼‰ï¼š**
- âŒ ROIè¦†ç›–ç‡ï¼š67.8%ï¼ˆå¤ªé«˜ï¼ï¼‰
- âŒ æ£€æµ‹åˆ°çš„åŒºåŸŸæ•°ï¼š**åªæœ‰1ä¸ª**ï¼ˆåº”è¯¥æ˜¯10-15ä¸ªç‹¬ç«‹ç®¡å­ï¼‰
- âŒ ç®¡å­ä¹‹é—´çš„ç°è‰²ç¼éš™ä¹Ÿè¢«åŒ…å«äº†
- âœ… æ‰€æœ‰ç™½è‰²ç®¡å­éƒ½è¢«è¦†ç›–åˆ°äº†

**ä»å¯è§†åŒ–å›¾çœ‹åˆ°ï¼š**
- å­å›¾3ï¼šROIæ©ç å‡ ä¹è¦†ç›–æ•´ä¸ªä¸­é—´åŒºåŸŸï¼Œä¸æ˜¯ç‹¬ç«‹çš„ç®¡å­
- å­å›¾4ï¼šç»¿è‰²è¾¹ç•Œè¿æˆä¸€ç‰‡ï¼Œä¸æ˜¯åˆ†ç¦»çš„
- å­å›¾6ï¼šç™½è‰²åŒºåŸŸå¤ªå¤šï¼ŒåŒ…å«äº†ç¼éš™
- å­å›¾7-8ï¼šçº¢è‰²ROIçº¿å‡ ä¹æ˜¯è¿ç»­çš„ï¼Œæ²¡æœ‰æ˜æ˜¾çš„é—´æ–­

### æ ¹æœ¬åŸå› 

**äº®åº¦é˜ˆå€¼0.15å¤ªä½ï¼š**
```
ç™½è‰²ç®¡å­ï¼š     äº®åº¦ > 0.40  â†’ åŒ…å« âœ…
ç°è‰²ç¼éš™ï¼š     äº®åº¦ 0.15-0.30 â†’ ä¹Ÿè¢«åŒ…å« âŒ
é»‘è‰²èƒŒæ™¯ï¼š     äº®åº¦ < 0.15  â†’ æ’é™¤ âœ…
```

## âœ… å·²åº”ç”¨çš„ä¿®å¤

### ä¿®æ”¹1ï¼šæé«˜é»˜è®¤äº®åº¦é˜ˆå€¼

**æ–‡ä»¶ï¼š** `detect_ceramic_roi.m`

```matlab
% æ—§å€¼
opts.BrightnessThreshold (1,1) double = 0.20

% æ–°å€¼
opts.BrightnessThreshold (1,1) double = 0.30
```

**æ•ˆæœï¼š**
- åªåŒ…å«äº®åº¦>0.30çš„åŒºåŸŸï¼ˆç™½è‰²ç®¡å­ï¼‰
- æ’é™¤äº®åº¦0.15-0.30çš„åŒºåŸŸï¼ˆç°è‰²ç¼éš™ï¼‰

### ä¿®æ”¹2ï¼šè°ƒæ•´å½¢æ€å­¦å‚æ•°

```matlab
% æ—§å€¼
opts.MorphCloseRadius = 20  % å¤ªå¤§ï¼Œä¼šè¿æ¥ç¼éš™
opts.MorphOpenRadius = 10

% æ–°å€¼
opts.MorphCloseRadius = 15  % é€‚ä¸­ï¼Œä¸ä¼šè¿‡åº¦è¿æ¥
opts.MorphOpenRadius = 15   % å¢å¤§ï¼Œæ›´å¥½åœ°åˆ†ç¦»ç‹¬ç«‹ç®¡å­
```

### ä¿®æ”¹3ï¼šé™ä½æœ€å°é¢ç§¯è¦æ±‚

```matlab
% æ—§å€¼
opts.MinAreaRatio = 0.05  % 5%ï¼Œå¯èƒ½æ¼æ‰è¾¹ç¼˜çš„ç®¡å­

% æ–°å€¼
opts.MinAreaRatio = 0.03  # 3%ï¼Œç¡®ä¿æ‰€æœ‰ç®¡å­éƒ½ä¿ç•™
```

### ä¿®æ”¹4ï¼šæ›´æ–°pipelineé»˜è®¤å€¼

**æ–‡ä»¶ï¼š** `ceramic_defect_pipeline.m`

```matlab
% æ—§å€¼
opts.ROIBrightnessThreshold = 0.15;

# æ–°å€¼
opts.ROIBrightnessThreshold = 0.30;
```

## ğŸ“ˆ é¢„æœŸæ”¹è¿›æ•ˆæœ

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤åï¼ˆé¢„æœŸï¼‰ |
|------|--------|---------------|
| **ROIè¦†ç›–ç‡** | 67.8% | 40-50% âœ… |
| **åŒºåŸŸæ•°é‡** | 1ä¸ª | 10-15ä¸ª âœ… |
| **åŒ…å«å†…å®¹** | ç®¡å­+ç¼éš™ | åªæœ‰ç®¡å­ âœ… |
| **å­å›¾6æ•ˆæœ** | ç™½è‰²åŒºåŸŸè¿ç»­ | ç‹¬ç«‹çš„ç®¡å­åŒºåŸŸ âœ… |

## ğŸ” éªŒè¯æ–¹æ³•

### æ–¹æ³•1ï¼šæŸ¥çœ‹æ–°çš„å¯è§†åŒ–ç»“æœ

```matlab
cd 'd:\Projects\PyCharm Projects\Ceramic_Defect_Detection\matlab'
visualize_roi_detail
```

**æ£€æŸ¥æ¸…å•ï¼š**
- â–¡ ROIè¦†ç›–ç‡é™åˆ°40-55%ï¼Ÿ
- â–¡ æ£€æµ‹åˆ°10-15ä¸ªç‹¬ç«‹åŒºåŸŸï¼Ÿ
- â–¡ å­å›¾6ä¸­ï¼Œç™½è‰²åŒºåŸŸæ˜¯ç‹¬ç«‹çš„ç®¡å­ï¼Œé»‘è‰²ç¼éš™æ¸…æ™°å¯è§ï¼Ÿ
- â–¡ å­å›¾7-8ä¸­ï¼Œçº¢è‰²ROIçº¿æœ‰æ˜æ˜¾çš„é—´æ–­ï¼Ÿ

### æ–¹æ³•2ï¼šæµ‹è¯•é˜ˆå€¼èŒƒå›´

```matlab
test_roi_threshold
```

æŸ¥çœ‹0.25ã€0.30ã€0.35çš„æ•ˆæœå¯¹æ¯”

### æ–¹æ³•3ï¼šè¿è¡Œå®Œæ•´æ£€æµ‹

```matlab
auto_run
quick_view
```

## ğŸ¯ æˆåŠŸæ ‡å‡†

### âœ… ä¿®å¤æˆåŠŸçš„æ ‡å¿—ï¼š

1. **å­å›¾3ï¼ˆROIæ©ç ï¼‰ï¼š**
   - å¯ä»¥çœ‹åˆ°ç‹¬ç«‹çš„ç™½è‰²æ¡çº¹ï¼ˆå¯¹åº”æ¯æ ¹ç®¡å­ï¼‰
   - æ¡çº¹ä¹‹é—´æœ‰é»‘è‰²é—´éš™ï¼ˆç¼éš™ï¼‰

2. **å­å›¾4ï¼ˆè¾¹ç•Œå åŠ ï¼‰ï¼š**
   - 10-15ä¸ªç‹¬ç«‹çš„ç»¿è‰²è½®å»“
   - æ¯ä¸ªè½®å»“åŒ…å›´ä¸€æ ¹ç®¡å­

3. **å­å›¾6ï¼ˆåªä¿ç•™ROIï¼‰ï¼š**
   - ç™½è‰²åŒºåŸŸï¼šç‹¬ç«‹çš„ç®¡å­
   - é»‘è‰²åŒºåŸŸï¼šç¼éš™å’ŒèƒŒæ™¯
   - ç®¡å­ä¹‹é—´çš„ç¼éš™æ¸…æ™°å¯è§

4. **ç»Ÿè®¡æ•°æ®ï¼š**
   - ROIè¦†ç›–ç‡ï¼š40-50%
   - æ£€æµ‹åŒºåŸŸæ•°ï¼š10-15ä¸ª

### âŒ å¦‚æœè¿˜æœ‰é—®é¢˜ï¼š

**å¦‚æœè¦†ç›–ç‡ä»>55%ï¼š**
```matlab
% è¿›ä¸€æ­¥æé«˜é˜ˆå€¼
roiMask = detect_ceramic_roi(Igray, 'BrightnessThreshold', 0.35);
```

**å¦‚æœæœ‰ç®¡å­æœªè¦†ç›–ï¼š**
```matlab
% é™ä½é˜ˆå€¼
roiMask = detect_ceramic_roi(Igray, 'BrightnessThreshold', 0.25);
```

**å¦‚æœåŒºåŸŸæ•°<10ï¼š**
```matlab
% å‡å°MorphCloseRadiusï¼Œé¿å…è¿‡åº¦è¿æ¥
roiMask = detect_ceramic_roi(Igray, ...
    'MorphCloseRadius', 10, ...
    'MorphOpenRadius', 20);
```

## ğŸ“ ä¸‹ä¸€æ­¥

1. **ç­‰å¾…æ–°çš„visualize_roi_detailè¿è¡Œå®Œæˆ**ï¼ˆæ­£åœ¨åå°è¿è¡Œï¼‰
2. **æŸ¥çœ‹æ–°çš„å¯è§†åŒ–ç»“æœ**
3. **å¯¹æ¯”ä¿®å¤å‰åçš„å·®å¼‚**
4. **å¦‚æœæ»¡æ„ï¼Œè¿è¡Œauto_runè¿›è¡Œå®Œæ•´æ£€æµ‹**

## ğŸ’¬ åé¦ˆç»™æˆ‘

æ–°çš„å¯è§†åŒ–ç»“æœå‡ºæ¥åï¼Œå‘Šè¯‰æˆ‘ï¼š

1. âœ… ROIè¦†ç›–ç‡æ˜¯å¤šå°‘ï¼Ÿï¼ˆæœŸæœ›40-50%ï¼‰
2. âœ… æ£€æµ‹åˆ°å¤šå°‘ä¸ªåŒºåŸŸï¼Ÿï¼ˆæœŸæœ›10-15ä¸ªï¼‰
3. âœ… å­å›¾6çœ‹èµ·æ¥æ˜¯å¦æ­£ç¡®ï¼Ÿï¼ˆç‹¬ç«‹çš„ç®¡å­ï¼‰
4. âœ… æ˜¯å¦è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Ÿ

## ğŸ”§ å¿«é€Ÿè°ƒæ•´å‘½ä»¤

å¦‚æœéœ€è¦å¾®è°ƒï¼š

```matlab
cd 'd:\Projects\PyCharm Projects\Ceramic_Defect_Detection\matlab'

% æµ‹è¯•ä¸åŒé˜ˆå€¼
Igray = im2double(rgb2gray(imread('../samples/20250929_defect_01.jpg')));

% æµ‹è¯•0.30ï¼ˆå½“å‰é»˜è®¤ï¼‰
roi30 = detect_ceramic_roi(Igray, 'BrightnessThreshold', 0.30);
fprintf('é˜ˆå€¼0.30: è¦†ç›–ç‡%.1f%%\n', sum(roi30(:))/numel(roi30)*100);

% æµ‹è¯•0.35ï¼ˆæ›´ä¸¥æ ¼ï¼‰
roi35 = detect_ceramic_roi(Igray, 'BrightnessThreshold', 0.35);
fprintf('é˜ˆå€¼0.35: è¦†ç›–ç‡%.1f%%\n', sum(roi35(:))/numel(roi35)*100);

% å¯¹æ¯”æ˜¾ç¤º
figure;
subplot(1,2,1); imshow(roi30); title('é˜ˆå€¼0.30');
subplot(1,2,2); imshow(roi35); title('é˜ˆå€¼0.35');
```

---

**ä¿®å¤å·²åº”ç”¨ï¼æ­£åœ¨è¿è¡Œæ–°çš„å¯è§†åŒ–éªŒè¯...** â³

